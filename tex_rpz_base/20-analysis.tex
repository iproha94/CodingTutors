\chapter{Аналитический раздел}

\section{Описание предметной области}
Для студентов технических вузов обязателен предмет программирование. Но большинство имеет проблемы при изучении этого предмета. Многие находят выход в списывании, что несомненно подрывает российское образование. Некоторые обращаются к репетиторам, но эти услуги стоит больших денег, и формат таких занятий не совсем подходит к теме IT образования. Более правильный подход - находить помощника для конкретных возникших проблем, будь то лабораторная работа или контрольная по определенной теме.

Сайт должен позволять зарегистрироваться и авторизоваться неавторизованным пользователям. Регистрация предполагает ввод имени, фамилии, e-mail, пароля и выбора университета. При авторизации необходимо ввести e-mail и пароль.
Авторизованные пользователи должны иметь возможность выйти из сайта.

На сайте должны быть два вида пользователей: человек, который запрашивает услугу (далее ученик) и человек, который предлагает услугу (далее репетитор). Однако, один человек может как нуждаться в услуге, так и предлагать её. Поэтому на сайте должен быть один вид пользователя, с одинаковыми возможностями как запрашивать услугу, так и предлагать её.

Основная функция сайта - это создание задач, по которым нужно получить помощь. Пользователь (ученик) должен иметь возможность создавать задачу, просматривать свои задачи, отсортированные по времени, закрывать неактуальные задачи, видеть предложения, оставленные репетиторами. Т.о. задача состоит из: названия, текста условия, флага актуальности, даты создания.

Перед тем, как создать задачу, пользователю может пригодиться поиск по всем опубликованным задачам, и просмотреть список откликнувшихся репетиторов к этим задачам.  Это позволит не создавать новую задачу, а сразу обратиться к нужному репетитору, который сможет помочь.

Репетиторы должны иметь возможность просматривать все актуальные задачи, оставлять заявки к ним или видеть, что заявка уже оставлена им ранее.

Заявка должна включать в себя номер задачи, к которой она оставляется, идентификатор репетитора и комментарий репетитора.

Для удобного просмотра задач, необходимо ввести понятие категория. Пользователь, при создании задачи, должен выбрать, к какой категории относится задача.  Репетитор может выбрать категорию, по которой он хочет видеть актуальные задачи. Пример задачи в таблице ~\ref{table:example-task}. 

\begin{table}[h]
\caption{Пример задачи}\label{table:example-task}
\medskip
\begin{tabular}{|l|p{13cm}|}
\hline
Название & Помогите решить задачу на C  \\
Категория & Structured \\ 
Описание & В задаче нужно вывести на экран интеграл функции y = x * x на отрезке -43 1020 \\
\hline
\end{tabular}
\end{table}

Так как задач может быть много, необходимо ввести пагинацию.

На одну задачу могут откликнуться большое количество репетиторов, поэтому необходимо помочь ученику выбрать нужного репетитора. Для этого вводится понятие полезности заявки. Этот показатель будет высчитываться из совпадений данных ученика и репетитора, а также рейтинга репетитора. Например при регистрации необходимо указать университет, и если ученик и репетитор учатся/учились в одном университете, то ценность заявки возрастает. Связанно это с тем, что ученик и репетитор будут иметь возможность заниматься прямо в университете, а так же с тем, что репетитор возможно будет иметь представление, об преподавателях ученика, и преподаваемой программе в этом университете.

При просмотре заявок к задаче, автор задачи должен иметь возможность связаться с репетитором. Для этого указывается e-mail репетитора. Также автор может оценить заявку, что и будет влиять на рейтинг репетитора. Пример списка репетиторов к задаче в таблице ~\ref{table:example-list-rep}.

\begin{table}[h]
\caption{Пример списка репетиторов}\label{table:example-list-rep}.
\medskip
\begin{tabular}{|l|l|p{9cm}|}
\hline
email & соответствие & note\\
\hline
timur2@mail.ru & 0 & Это легко, помогу бесплатно\\
ilya16@yandex.ru & 10 & Помогу за еду\\
\hline
\end{tabular}
\end{table}

Так как создаваемый сайт имеет образовательную цель, то было бы полезно привести список рекомендуемой литературы. Этот список нужно разбить по категориям. Добавить книгу может любой человек. Книги можно оценивать.

\section{Определение требований к структуре базы данных}
Прежде чем начинать разработку модели данных, необходимо определить объема и типы данных, а также способа использования данных.
 
\subsection{Определение объема и типов данных }
\begin{enumerate}
\item Из анализа предметной области можно выделить следующие категории данных:
	\begin{itemize}
	\item Пользователи
	\item Задачи
	\item Книги
	\item Заявки
	\item Категории
	\item Университеты
	\end{itemize}


\item Для каждой категории данных необходимо учитывать типы сведений, указанных в таблице ~\ref{table:cat-and-type}.

\begin{table}[h]
\caption{Категории и типы сведений}\label{table:cat-and-type}
\medskip
\begin{tabular}{|l|p{12cm}|}
\hline
Категория & Типы сведений\\
\hline
Пользователи &  e-mail, университет, имя, фамилия, пароль, рейтинг\\
Задачи & пользователь создатель, категория, названия, описание, флаг актуальности, дата создания  \\
Книги & название, автор книги, рейтинг, категория \\
Заявки & задача, пользователь создатель, заметка, полезность заявки \\
Категории & название \\
Университеты & полное название, короткое название \\
\hline
\end{tabular}
\end{table}

\end{enumerate}

\subsection{Определение способа использования данных}
\begin{enumerate}

\item Из анализа предметной области можно определить следующие категории пользователей:

\begin{itemize}
\item Неавторизованные пользователи
\item Авторизованные пользователи (пользователи)
\end{itemize}

\item Каждая категория пользователей выполняет задачи, указанные в таблице ~\ref{table:cat-and-task}.
\begin{table}[h]
\caption{Категории пользователей и задачи}\label{table:cat-and-task}
\medskip
\begin{tabular}{|l|p{9cm}|}
\hline
Категории пользователей & Задачи\\
\hline
Авторизованные пользователи & выход, функции учениов и репетиторов \\
Неавторизованные пользователи & регистрация, авторизация\\ 
\hline
\end{tabular}
\end{table}

\item Из анализа предметной области можно определить следующие логические категории пользователей:
\begin{itemize}
\item Ученики
\item Репетиторы
\end{itemize}

\item Каждая логическая категория пользователей выполняет задачи, указанные в таблице ~\ref{table:log-cat-and-task}.
\begin{table}[h]
\caption{Логические категории пользователей и их задачи}\label{table:log-cat-and-task}
\medskip
\begin{tabular}{|l|p{10cm}|}
\hline
Категории пользователей & Задачи\\
\hline
Ученики & создавать задачи, закрывать свои задачи, оценивать заявки, осуществлять поиск по задачам \\
Репетиторы & просматривать актуальные задачи по категориям, оставлять заявки \\
Общие задачи & добавлять книги, просматривать книги по категориям, оценивать книги \\
\hline
\end{tabular}
\end{table}

\end{enumerate}

\subsection{Определение правил}
\begin{itemize}
\item данные о пользователе включают: имя, фамилию, e-mail, университет, пароль
\item имя, фамилия, e-mail и пароль не могут быть меньше 4 символов
\item пароль должен хранится в виде хеша от пароля в целях безопасности
\item университет выбирается из предоставленного списка
\item авторизация пользователя происходит по e-mail и паролю
\item сведения о задаче включают название, описание, категорию
\item сведения о книге включают название, авторы, категорию
\item пользователь должен иметь возможность просматривать список книг по категориям
\item пользователь должен иметь возможность просматривать список задач по категориям
\item пользователь может оценить книгу
\item пользователь может оценить одну книгу только один раз
\item пользователь может оставить заявку на задачу
\item данные о заявке на решение задачи включают комментарий пользователя
\item пользователь может оценивать заявку только на свои задачи
\item пользователь может оценить одну заявку только один раз
\item пользователь должен иметь возможность осуществлять поиск по задачам
\end{itemize}

\section{Разработка логической модели данных}

\subsection{Определение сущностей, связей между сущностями и атрибутов сущностей}

Чтобы определить, какие таблицы следует добавить к базе данных, следует обратиться к требованиям к системе, разработанным при анализе предметной области. Каждая выделенная категория (всего их 6) представляет основную таблицу и соответствующий табличный объект в структуре базы данных. Обозначим каждую таблицу названием одной из категорий. Для согласованности назовем таблицы так: Member, Task, Book, Category, WantToHelp, University. 

Согласно правилам из системных требований, пользователь может оценить одну книгу только один раз. Таблицы Member и Book имеют связь многие ко многим. Один пользователь может оценить несколько книг и одна книга может быть оценена несколькими пользователями. Добавим еще одну таблицу (Likebook) для учета оценки пользователя к книге. Теперь в общей сложности должно быть 7 таблиц. 

Для определения столбцов таблиц обратимся к требованиям к системе, разработанным при анализе предметной области. Для каждой категории данных определена информация, которая входит в эту категорию. Эта информация определяет столбцы. Добавляя к каждой таблице столбцы, следует помнить, что когда столбцы ссылаются на данные из связанной таблицы, обычно требуется столбец с идентификатором из связанной таблицы.

\begin{table}[h]
\caption{Таблицы и столбцы}
\medskip
\begin{tabular}{|l|p{12cm}|}
\hline
Таблица & Столбцы\\
\hline
Member & email, university, firstname, surname, hashpassword, likes\\
Task & taskId, memberEmail, categoryId, title, text, open, countWantToHelp, datetime\\
Book & bookId, categoryId, title, author, likes\\
Category & categoryId, name\\
WantToHelp & WantToHelpId, taskId, memberEmail, note, levelOfComplance, isLike\\
University & shortname, fullname\\
Likebook & memberEmail, bookId\\
\hline
\end{tabular}
\end{table}

\subsection{Диаграмма БД}
\begin{figure}[h]
  \centering
  \includegraphics[width=\textwidth]{er-diag.png}
  \caption{ER - диаграмма.}
\end{figure}



% \input{21-ranking}
% \input{22-collecting}
